#!/bin/sh
#
#CRGSå•å‘ä¼ è¾“ç³»ç»Ÿ1.0å…³é—­è„šæœ¬

#info="çŸ­ä¿¡é€šçŸ¥(owsmsalert) ç›‘ç®¡ç³»ç»Ÿ(owsysmonitor) å®šæ—¶æœåŠ¡æ‰§è¡Œç¨‹åº(owcron) è¯ä¹¦æœåŠ¡(owlicense) DBç®¡ç†ç¨‹åº(owdbmanager) Ftpç®¡ç†ç¨‹åº(owftpmanager) æ–‡ä»¶åŒæ­¥ç¨‹åº(owfilesync) ftpæœåŠ¡ç¨‹åº(owftpserver) æµé‡æ§åˆ¶ç®¡ç†ç¨‹åº(owmsgforward) ä»»åŠ¡ç®¡ç†å¤„ç†ç¨‹åº(owtskmanager) ä»»åŠ¡åˆ†å‘å¤„ç†ç¨‹åº(owtskdispatch)"
#prog="owsmsalert owsysmonitor owcron owlicense owdbmanager owftpmanager owfilesync owftpserver owmsgforward  owtskmanager owtskdispatch"


info="çŸ­ä¿¡é€šçŸ¥(owsmsalert) ç›‘ç®¡ç³»ç»Ÿ(owsysmonitor) å®šæ—¶æœåŠ¡æ‰§è¡Œç¨‹åº(owcron) è¯ä¹¦æœåŠ¡(owlicense)  Ftpç®¡ç†ç¨‹åº(owftpmanager) æ–‡ä»¶åŒæ­¥ç¨‹åº(owfilesync) ftpæœåŠ¡ç¨‹åº(owftpserver) æµé‡æ§åˆ¶ç®¡ç†ç¨‹åº(owmsgforward) ä»»åŠ¡ç®¡ç†å¤„ç†ç¨‹åº(owtskmanager) ä»»åŠ¡åˆ†å‘å¤„ç†ç¨‹åº(owtskdispatch)"

prog="owsmsalert owsysmonitor owcron owlicense  owftpmanager owfilesync owftpserver owmsgforward  owtskmanager owtskdispatch"


ipos=0
for i in $info
do
	echo  "å…³é—­ $i ..."
	jpos=0
	for j in $prog
	do
		if [ $ipos != $jpos ] ; then
			jpos=`expr $jpos + 1`
			continue
		else
			$j stop > /dev/null 2>&1
			sleep 2
#			clearprg $j
#			sleep 1
#			echo -n "..."
			number=`ps -u $LOGNAME | grep -c "[ ]$j\$"`
			if [ $number != 0 ] ; then
				echo "[1;31må…³é—­ç¨‹åº$jå¤±è´¥[0;37m"
				exit 1
			fi
			break
		fi
	done
	echo "[1;32mæˆåŠŸ![0;37m"
	ipos=`expr $ipos + 1`
done

echo "..."

echo "è¿›ç¨‹æ£€æŸ¥"
ps -ef|grep $LOGNAME|grep ow

